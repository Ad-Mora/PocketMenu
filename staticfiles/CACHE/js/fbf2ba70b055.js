var websiteHeader=(function(){var headerElement=document.querySelector("div.header");var hamburgerIcon=headerElement.querySelector("div.hamburger-icon-wrapper");var desktopSearchBar=headerElement.querySelector("form.header-search-bar-with-icon");var searchIcon=headerElement.querySelector("img.search-icon");return{headerContainer:headerElement,categoriesIcon:hamburgerIcon,headerSearchBar:desktopSearchBar,mobileSearchIcon:searchIcon};})();var documentModule=(function(){document.addEventListener('keydown',callKeypressFunctions);window.addEventListener('resize',callResizeFunctions);window.addEventListener('click',callClickFunctions);document.addEventListener('scroll',callScrollFunctions);var onKeyPressEvents=[];var onResizeEvents=[];var onClickEvents=[];var onScrollEvents=[];function callKeypressFunctions(event){for(var i=0;i<onKeyPressEvents.length;i++){(onKeyPressEvents[i])(event);}}
function callResizeFunctions(event){for(var i=0;i<onResizeEvents.length;i++){(onResizeEvents[i])(event);}}
function callClickFunctions(event){for(var i=0;i<onClickEvents.length;i++){(onClickEvents[i])(event);}}
function callScrollFunctions(event){for(var i=0;i<onScrollEvents.length;i++){(onScrollEvents[i])(event);}}
function addOnKeyPressFunction(func){onKeyPressEvents.push(func)}
function addOnResizeFunction(func){onResizeEvents.push(func)}
function addOnClickFunction(func){onClickEvents.push(func);}
function addOnScrollFunction(func){onScrollEvents.push(func);}
return{addOnKeyPressFunction:addOnKeyPressFunction,addOnResizeFunction:addOnResizeFunction,addOnClickFunction:addOnClickFunction,addOnScrollFunction:addOnScrollFunction};})();var ajax=(function(){function getCSRFToken(){var csrfCookie=document.cookie.split(';')[0];var csrfTokenValue=csrfCookie.split('=')[1];return csrfTokenValue}
function send_ajax_request(destination_file,json_data,csrftoken,postAjaxFunction){var xmlhttp;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest();}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}
xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){postAjaxFunction(xmlhttp.responseText);}};xmlhttp.open("POST",destination_file,true);xmlhttp.setRequestHeader("X-CSRFToken",csrftoken);xmlhttp.send(JSON.stringify(json_data));}
return{send_ajax_request:send_ajax_request,getCSRFToken:getCSRFToken};})();var swipeGesture=(function(){function _swipeGestureData(dragCallback){this.swipeDirection;this.startX;this.startY;this.deltaX;this.deltaY;}
function _beginSwipeGesture(event,data,dragHandler){var touchPoint=event.changedTouches[0];data.swipeDirection='none';data.deltaX=0;data.deltaY=0;data.startX=touchPoint.pageX;data.startY=touchPoint.pageY;dragHandler(data.direction,data.deltaX,data.deltaY);event.preventDefault();}
function _duringSwipeGesture(event,data,dragHandler){var touchPoint=event.changedTouches[0];data.deltaX=touchPoint.pageX-data.startX;data.deltaY=touchPoint.pageY-data.startY;if(Math.abs(data.deltaX)>=Math.abs(data.deltaY)){data.swipeDirection=(data.deltaX<=0)?'left':'right';}
else{data.swipeDirection=(data.deltaY<=0)?'up':'down';}
dragHandler(data.swipeDirection,data.deltaX,data.deltaY);event.preventDefault();}
function _endSwipeGesture(event,data,swipeCallback){swipeCallback(data.swipeDirection,data.deltaX,data.deltaY);event.preventDefault();}
function addSwipeListener(element,swipeCallback){var noDragHandler=function(deltaX,deltaY){}
addSwipeAndDragListener(element,noDragHandler,swipeCallback);}
function addSwipeAndDragListener(element,dragHandler,swipeCallback){var data=new _swipeGestureData();element.addEventListener('touchstart',function(event){_beginSwipeGesture(event,data,dragHandler);});element.addEventListener('touchmove',function(event){_duringSwipeGesture(event,data,dragHandler);});element.addEventListener('touchend',function(event){_endSwipeGesture(event,data,swipeCallback);});}
return{addSwipeListener:addSwipeListener,addSwipeAndDragListener:addSwipeAndDragListener};})();var foodFavoriting=(function(){var dictOfFavoriteFoods=fetchOrInitializeFavoriteFoodsDict();var setFoodInterestForLoadedFoods=setInterestDataForFoodList();function saveNewFoodInterest(foodElement,newFoodInterest){var foodIdentifier=foodElement.getAttribute("data-food-unique-id");dictOfFavoriteFoods[foodIdentifier]=newFoodInterest;localStorage.setItem("dictOfFavoriteFoods",JSON.stringify(dictOfFavoriteFoods));}
function fetchOrInitializeFavoriteFoodsDict(){if(localStorage.getItem("dictOfFavoriteFoods")!==null){return JSON.parse(localStorage.getItem("dictOfFavoriteFoods"));}
localStorage.setItem("dictOfFavoriteFoods",JSON.stringify({}));return{};}
function setInterestDataForFoodList(){var listOfAllFoodEntries=document.querySelectorAll("li.food-entry-li");for(var i=0;i<listOfAllFoodEntries.length;i++){var foodElement=listOfAllFoodEntries[i];var foodID=foodElement.getAttribute("data-food-unique-id");if(dictOfFavoriteFoods[foodID]!==undefined){foodElement.setAttribute("data-food-is-liked",dictOfFavoriteFoods[foodID]);}}}
return{saveNewFoodInterest:saveNewFoodInterest,setInterestDataForFoodList:setInterestDataForFoodList};})();var foodEntry=(function(){var listOfFoodEntryLI;var MAX_NUMBER_OF_SCROLL_LISTENERS=4;var scrollListenersCount=0;var bufferCutOffDepth=window.innerHeight+500;var intializeFoodEntries=bindAllFoodEntriesWithClickEvent();function loadActualImageForFoodEntry(foodEntry){var actualSrc=foodEntry.getAttribute("data-food-image-location");var foodEntryImage=foodEntry.querySelector("img");var tempImage=new Image();tempImage.onload=function(event){foodEntryImage.src=this.src;foodEntry.classList.remove("unloaded-image");}
tempImage.src=actualSrc;}
function displayInspectorViewForFood(event){allInspectorView.showInspectorView(this);}
function loadFoodsAboveBufferCutoff(){var foodsToLoad=document.querySelectorAll("li.unloaded-image");for(var i=0;i<foodsToLoad.length;i++){var verticalImageOffset=foodsToLoad[i].getBoundingClientRect().top;if(verticalImageOffset<bufferCutOffDepth){loadActualImageForFoodEntry(foodsToLoad[i]);}}}
function getNextFoodItem(foodItem){var currentFoodIndex=foodItem.getAttribute("data-list-item-number");var nextFoodIndex=++currentFoodIndex;if(nextFoodIndex==listOfFoodEntryLI.length){return listOfFoodEntryLI[0];}
return listOfFoodEntryLI[nextFoodIndex];}
function getPreviousFoodItem(foodItem){var currentFoodIndex=foodItem.getAttribute("data-list-item-number");var previousFoodIndex=--currentFoodIndex;if(previousFoodIndex==-1){return listOfFoodEntryLI[listOfFoodEntryLI.length-1];}
return listOfFoodEntryLI[previousFoodIndex];}
function bindAllFoodEntriesWithClickEvent(){listOfFoodEntryLI=document.querySelectorAll("li.food-entry-li");for(var i=0;i<listOfFoodEntryLI.length;i++){var foodEntryElement=listOfFoodEntryLI[i];foodEntryElement.addEventListener('click',displayInspectorViewForFood);foodEntryElement.setAttribute("data-list-item-number",i);}
document.removeEventListener('scroll',loadFoodsAboveBufferCutoff);document.addEventListener('scroll',loadFoodsAboveBufferCutoff);loadFoodsAboveBufferCutoff();return listOfFoodEntryLI;}
return{"getNextFoodItem":getNextFoodItem,"getPreviousFoodItem":getPreviousFoodItem,bindAllFoodEntriesWithClickEvent:bindAllFoodEntriesWithClickEvent};})();var allInspectorView=(function(){var allInspectorsWrapper=document.querySelector("div.all-inspector-views-wrapper");var interestActionSign=allInspectorsWrapper.querySelector("div.interest-action-positioner");var mobileBackgroundOverlay=allInspectorsWrapper.querySelector("div.mobile-inspector-background-overlay");var desktopBackgroundOverlay=allInspectorsWrapper.querySelector("div.desktop-inspector-background-overlay");mobileBackgroundOverlay.addEventListener('click',hideInspectorView);desktopBackgroundOverlay.addEventListener('click',hideInspectorView);var currentFood;var foodInterestStates={true:"like-food",false:"not-like-food"};var inspectorIsOpen=false;var onKeyPress=keyPressFunction();function _displayInterestActionSign(foodIsLiked){var interestMessageDict={true:"Item saved to \"Favorites\".",false:"Item removed from \"Favorites\"."}
var oldOne=interestActionSign;interestActionSign=oldOne.cloneNode(true);var interestActionMessage=interestActionSign.querySelector("p.interest-action-taken");interestActionMessage.innerHTML=interestMessageDict[foodIsLiked];oldOne.parentNode.replaceChild(interestActionSign,oldOne);interestActionSign.style.display="block";}
function keyPressFunction(){var ESCAPE_KEY_CODE=27;var RIGHT_ARROW_KEY_CODE=39;var LEFT_ARROW_KEY_CODE=37;documentModule.addOnKeyPressFunction(function(event){if(inspectorIsOpen){if(event.keyCode==ESCAPE_KEY_CODE){hideInspectorView(event);}
else if(event.keyCode==RIGHT_ARROW_KEY_CODE){showNextFood();}
else if(event.keyCode==LEFT_ARROW_KEY_CODE){showPreviousFood();}}});}
function showInspectorView(clickedFood){mobileInspectorView.initializeMobileViewWithFood(clickedFood);desktopInspectorView.initializeDesktopViewWithFood(clickedFood);currentFood=clickedFood;inspectorIsOpen=true;interestActionSign.style.display="none";allInspectorsWrapper.style.display="block";}
function hideInspectorView(event){allInspectorsWrapper.style.display="none";inspectorIsOpen=false;}
function showNextFood(event){var nextFood=foodEntry.getNextFoodItem(currentFood);showInspectorView(nextFood);}
function showPreviousFood(event){var previousFood=foodEntry.getPreviousFoodItem(currentFood);showInspectorView(previousFood);}
function toggleInterestInFood(event){var newInterestInFood=!(currentFood.getAttribute("data-food-is-liked")=="true");currentFood.setAttribute("data-food-is-liked",newInterestInFood);setInterestIconBasedOnCurrentInterest(desktopInspectorView.interestIcon,currentFood);setInterestIconBasedOnCurrentInterest(mobileInspectorView.interestIcon,currentFood);foodFavoriting.saveNewFoodInterest(currentFood,newInterestInFood);_displayInterestActionSign(newInterestInFood);}
function setInterestIconBasedOnCurrentInterest(interestIcon,foodElement){var interestInFood=foodElement.getAttribute("data-food-is-liked")=="true";interestIcon.className=interestIcon.className.replace(" "+foodInterestStates[!interestInFood]," "+foodInterestStates[interestInFood]);}
return{showInspectorView:showInspectorView,hideInspectorView:hideInspectorView,showNextFood:showNextFood,showPreviousFood:showPreviousFood,toggleInterestInFood:toggleInterestInFood,setInterestIconBasedOnCurrentInterest:setInterestIconBasedOnCurrentInterest};})();var mobileInspectorView=(function(){var listOfMobileInspectors=document.querySelector("ul.list-of-mobile-inspectors");var mobileInspector=listOfMobileInspectors.querySelector("li.mobile-inspector-view-wrapper");var leftInspectorView=mobileInspector.cloneNode(true);var rightInspectorView=mobileInspector.cloneNode(true);var rightMobilePictureIcon=mobileInspector.querySelector("span.right-arrow");var leftMobilePictureIcon=mobileInspector.querySelector("span.left-arrow");var mobileInterestIcon=mobileInspector.querySelector("span.interested-in-food-icon");var mobileFoodImage=mobileInspector.querySelector("img.food-image");var exitMobileInspectorIcon=mobileInspector.querySelector("span.close-inspector-icon");var restaurantLinkIcon=mobileInspector.querySelector("a.restaurant-page-link");swipeGesture.addSwipeAndDragListener(mobileFoodImage,_whileDraggingImage,_onDragEnd);rightMobilePictureIcon.addEventListener('click',allInspectorView.showNextFood);leftMobilePictureIcon.addEventListener('click',allInspectorView.showPreviousFood);mobileInterestIcon.addEventListener('click',allInspectorView.toggleInterestInFood);exitMobileInspectorIcon.addEventListener('click',allInspectorView.hideInspectorView);var RIGHT_POSITION=0;var CENTER_POSITION=-1*window.innerWidth;var LEFT_POSITION=-2*window.innerWidth;var previousFood;var centerFood;var nextFood;var initializeInspectorViewList=_addLeftAndRightInspectorView();var intializeInspectorViewDimensions=_changeInspectorViewDimensionsOnResize();var enableInspectorViewResize=documentModule.addOnResizeFunction(_changeInspectorViewDimensionsOnResize);function _changeInspectorViewDimensionsOnResize(event){listOfMobileInspectors.style.width=3*window.innerWidth+"px";listOfMobileInspectors.style.webkitTransform="translate3d(-"+window.innerWidth+"px,0px,0px)";listOfMobileInspectors.style.mozTransform="translate3d(-"+window.innerWidth+"px,0px,0px)";listOfMobileInspectors.style.transform="translate3d(-"+window.innerWidth+"px,0px,0px)";leftInspectorView.style.width=window.innerWidth+"px";mobileInspector.style.width=window.innerWidth+"px";rightInspectorView.style.width=window.innerWidth+"px";RIGHT_POSITION=0;CENTER_POSITION=-1*window.innerWidth;LEFT_POSITION=-2*window.innerWidth;}
function _addLeftAndRightInspectorView(){listOfMobileInspectors.insertBefore(leftInspectorView,mobileInspector);listOfMobileInspectors.appendChild(rightInspectorView);}
function _whileDraggingImage(direction,deltaX,deltaY){listOfMobileInspectors.style.webkitTransform="translate3d("+(-1*(window.innerWidth-deltaX))+"px,0px,0px)";listOfMobileInspectors.style.mozTransform="translate3d("+(-1*(window.innerWidth-deltaX))+"px,0px,0px)";listOfMobileInspectors.style.transform="translate3d("+(-1*(window.innerWidth-deltaX))+"px,0px,0px)";}
function _onDragEnd(direction,deltaX,deltaY){var MIN_SWIPE_DISTANCE=window.innerWidth*0.4;if(direction=='left'&&Math.abs(deltaX)>MIN_SWIPE_DISTANCE){listOfMobileInspectors.style.webkitTransform="translate3d("+LEFT_POSITION+"px,0px,0px)";listOfMobileInspectors.style.mozTransform="translate3d("+LEFT_POSITION+"px,0px,0px)";listOfMobileInspectors.style.transform="translate3d("+LEFT_POSITION+"px,0px,0px)";allInspectorView.showNextFood(null);}
else if(direction=='right'&&Math.abs(deltaX)>MIN_SWIPE_DISTANCE){listOfMobileInspectors.style.webkitTransform="translate3d("+RIGHT_POSITION+"px,0px,0px)";listOfMobileInspectors.style.mozTransform="translate3d("+RIGHT_POSITION+"px,0px,0px)";listOfMobileInspectors.style.transform="translate3d("+RIGHT_POSITION+"px,0px,0px)";allInspectorView.showPreviousFood(null);}
else{listOfMobileInspectors.style.mozTransform="translate3d("+CENTER_POSITION+"px,0px,0px)";listOfMobileInspectors.style.webkitTransform="translate3d("+CENTER_POSITION+"px,0px,0px)";listOfMobileInspectors.style.transform="translate3d("+CENTER_POSITION+"px,0px,0px)";}}
function _populateMobileViewWithFoodData(mobileView,foodElement){var foodNameElement=mobileView.querySelector("h3.food-name");var foodDetailsElement=mobileView.querySelector("p.food-description");var foodImageElement=mobileView.querySelector("img.food-image");var foodPriceElement=mobileView.querySelector("p.food-price");var categoryNameElement=mobileView.querySelector("h4.food-category-name");var categoryDescriptionElement=mobileView.querySelector("p.food-category-description");var restaurantHeaderLinkElement=mobileView.querySelector("h2.inspector.restaurant-name a");var foodName=foodElement.getAttribute("data-food-name");foodNameElement.innerHTML=foodName;foodImageElement.alt=foodName;var foodDetails=foodElement.getAttribute("data-food-details");foodDetailsElement.innerHTML=foodDetails;var foodImageLocation=foodElement.getAttribute("data-food-image-location");foodImageElement.src=foodImageLocation;var foodPrice=foodElement.getAttribute("data-food-price");foodPriceElement.innerHTML=foodPrice;var categoryName=foodElement.getAttribute("data-category-name");categoryNameElement.innerHTML=categoryName;var categoryDescription=foodElement.getAttribute("data-category-description");categoryDescriptionElement.innerHTML=categoryDescription;var restaurantName=foodElement.getAttribute("data-restaurant-name");restaurantHeaderLinkElement.innerHTML=restaurantName;var restaurantLink=foodElement.getAttribute("data-restaurant-link");restaurantHeaderLinkElement.href=restaurantLink;restaurantLinkIcon.href=restaurantLink;var interestIconForView=mobileView.querySelector("span.inspector.interested-in-food-icon");allInspectorView.setInterestIconBasedOnCurrentInterest(interestIconForView,foodElement);}
function initializeMobileViewWithFood(foodElement){previousFood=foodEntry.getPreviousFoodItem(foodElement);centerFood=foodElement;nextFood=foodEntry.getNextFoodItem(foodElement);listOfMobileInspectors.style.webkitTransform="translate3d("+CENTER_POSITION+"px,0px,0px)";listOfMobileInspectors.style.mozTransform="translate3d("+CENTER_POSITION+"px,0px,0px)";listOfMobileInspectors.style.transform="translate3d("+CENTER_POSITION+"px,0px,0px)";_populateMobileViewWithFoodData(leftInspectorView,previousFood);_populateMobileViewWithFoodData(mobileInspector,centerFood);_populateMobileViewWithFoodData(rightInspectorView,nextFood);}
return{interestIcon:mobileInterestIcon,initializeMobileViewWithFood:initializeMobileViewWithFood};})();var desktopInspectorView=(function(){var desktopInspector=document.querySelector("div.food-modal-container");var rightDesktopPictureIcon=desktopInspector.querySelector("span.food-modal-right-arrow-icon");var leftDesktopPictureIcon=desktopInspector.querySelector("span.food-modal-left-arrow-icon");var desktopInterestIcon=desktopInspector.querySelector("span.food-interest-icon");var exitDesktopInspectorIcon=desktopInspector.querySelector("span.exit-food-modal-icon");var foodImageElement=desktopInspector.querySelector("img.food-modal-image");var restaurantHeaderLinkElement=desktopInspector.querySelector("h3.food-modal-restaurant-name a");var foodNameElement=desktopInspector.querySelector("h1.food-modal-food-name");var foodDetailsElement=desktopInspector.querySelector("p.food-modal-food-description");var categoryNameElement=desktopInspector.querySelector("h5.food-modal-category-name");var categoryDescriptionElement=desktopInspector.querySelector("p.food-modal-category-details");var foodPriceElement=desktopInspector.querySelector("span.food-modal-food-price");rightDesktopPictureIcon.addEventListener('click',allInspectorView.showNextFood);leftDesktopPictureIcon.addEventListener('click',allInspectorView.showPreviousFood);desktopInterestIcon.addEventListener('click',allInspectorView.toggleInterestInFood);exitDesktopInspectorIcon.addEventListener('click',allInspectorView.hideInspectorView);function initializeDesktopViewWithFood(foodElement){var foodName=foodElement.getAttribute("data-food-name");foodNameElement.innerHTML=foodName;foodImageElement.alt=foodName;var foodDetails=foodElement.getAttribute("data-food-details");foodDetailsElement.innerHTML=foodDetails;var foodImageLocation=foodElement.getAttribute("data-food-image-location");foodImageElement.src=foodImageLocation;var foodPrice=foodElement.getAttribute("data-food-price");foodPriceElement.innerHTML=foodPrice;var categoryName=foodElement.getAttribute("data-category-name");categoryNameElement.innerHTML=categoryName;var categoryDescription=foodElement.getAttribute("data-category-description");categoryDescriptionElement.innerHTML=categoryDescription;var restaurantName=foodElement.getAttribute("data-restaurant-name");restaurantHeaderLinkElement.innerHTML=restaurantName;var restaurantLink=foodElement.getAttribute("data-restaurant-link");restaurantHeaderLinkElement.href=restaurantLink;var foodIsLiked=foodElement.getAttribute("data-food-is-liked");var listItemNumber=foodElement.getAttribute("data-list-item-number");allInspectorView.setInterestIconBasedOnCurrentInterest(desktopInterestIcon,foodElement);}
return{interestIcon:desktopInterestIcon,initializeDesktopViewWithFood:initializeDesktopViewWithFood};})();var masterSearch=(function(){var searchBarForm=document.querySelector("form.search-bar-form");var searchTypeRadioList=searchBarForm.querySelectorAll("input.search-option-radio-btn");var searchTypeSelect=searchBarForm.querySelector("select.select-search-type");var searchBar=searchBarForm.querySelector("input.search-bar");var searchSuggestions=searchBarForm.querySelector("ul.search-suggestions-list");searchBar.addEventListener("input",onSearchBarFocus);documentModule.addOnClickFunction(selectSuggestionsOrBlurEvent);searchBar.addEventListener("keyup",querySuggestions);searchTypeRadioList[0].addEventListener("change",updateSearchTypeSelect);searchTypeRadioList[1].addEventListener("change",updateSearchTypeSelect);searchTypeSelect.addEventListener("change",updateSearchTypeRadioButtons);function updateSearchTypeSelect(event){searchTypeSelect.value=event.target.value;searchBar.placeholder="Search for "+event.target.value+"s";}
function updateSearchTypeRadioButtons(event){searchBarForm.querySelector("input[name=radio-search-type][value="+event.target.value+"]").checked=true;searchBar.placeholder="Search for "+event.target.value+"s";}
function onSearchBarFocus(event){searchSuggestions.style.display="block";}
function selectSuggestionsOrBlurEvent(event){var targetElement=event.target;if(targetElement.parentNode===searchSuggestions){var suggestion_text=targetElement.innerHTML;searchBar.value=suggestion_text;searchBarForm.submit();}
else if(targetElement!==searchBar){}
searchSuggestions.style.display="none";}
function querySuggestions(event){var destination_file=event.target.getAttribute("data-autocomplete-suggestions-href");var search_type=searchBarForm.querySelector('input[name="radio-search-type"]:checked').value;var csrfMiddlewareToken=ajax.getCSRFToken();var json_data={"search-bar":searchBar.value,"search-type":search_type}
var postAjaxFunction=function(result){searchSuggestions.innerHTML=result;}
ajax.send_ajax_request(destination_file,json_data,csrfMiddlewareToken,postAjaxFunction);}
return{};})();